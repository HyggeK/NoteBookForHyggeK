# http发展的历程

http1.0 ——http1.1——http2.0——http3.0

https(SSL TLS)

# http1.0

1. 无状态
2. 80端口
3. 短连接
4. 使用TCP协议
5. 主要缺点：
   - 过多的RTT开销，导致延迟
   - 明文传输，导致不安全
   - 连接无法复用，导致过多的tcp连接在网络延迟较高的情景下十分影响体验

## http1.0用户点击鼠标之后发生的几个事件

1. 浏览器分析链接指向页面的URL
2. 浏览器向DNS请求解析域名的IP地址
3. 浏览器与服务器建立TCP连接
4. 浏览器发出操作命令
5. 服务器给出响应
6. 释放TCP连接
7. 浏览器显示响应结果

# http1.1

1. 支持持久连接
2. 流水线模式和非流水线模式（流水线模式允许请求方不必等待对应的响应信息，继续发送下一个请求）
3. TCP连接复用
4. 一个包含有许多图像的网页文件的多个请求和应答可以在一个连接中传输，但每个单独的网页文件的请求和应答仍然需要使用各自的连接
5. 添加更多的请求头和响应头来改进和扩充功能
   - Host请求头字段
   - 身份认证、状态管理、Cache缓存等机制的请求头
6. 缓存处理
7. 带宽优化以及网络连接的使用
8. 错误通知的管理
9. 消息在网络中的发送
10. 互联网地址的维护
11. 安全性及完整性

# http2.0

1. 使用二进制传输
2. 首部压缩
3. 让所有数据共用一个连接，解决tcp调谐导致的具有突发性和短时性的http低效问题
4. 服务端推送

# http3.0

1. 使用基于UDP的传输层协议QUIC
   1. 像TCP一样可靠
   2. 实现数据传输的0-RTT延迟
   3. 安全性保障
   4. 使用应用数据二进制分帧传输
   5. 彻底解决HOL阻塞问题，使不同的流之间真正的相互独立
   6. 切换网络时连接保持
   7. https://www.jianshu.com/p/bb3eeb36b479

# https

1. 使用SSL协议加密
2. 端口号443
3. 四次握手
   1. 浏览器将自己支持的一套加密规则发送给网站。
   2. 网站从中选出一组加密算法与HASH算法，并将自己的身份信息以证书的形式发回给浏览器。证书里面包含了网站地址，加密公钥，以及证书的颁发机构等信息。
   3. 获得网站证书之后浏览器要做以下工作：
      1. 验证证书的合法性（颁发证书的机构是否合法，证书中包含的网站地址是否与正在访问的地址一致等），如果证书受信任，则浏览器栏里面会显示一个小锁头，否则会给出证书不受信的提示。
      2. 如果证书受信任，或者是用户接受了不受信的证书，浏览器会生成一串随机数的密码，并用证书中提供的公钥加密。
      3. 使用约定好的HASH计算握手消息，并使用生成的随机数对消息进行加密，最后将之前生成的所有信息发送给网站。
   4. 网站接收浏览器发来的数据之后要做以下的操作：
      1. 使用自己的私钥将信息解密取出密码，使用密码解密浏览器发来的握手消息，并验证HASH是否与浏览器发来的一致。
      2. 使用密码加密一段握手消息，发送给浏览器。
   5. 浏览器解密并计算握手消息的HASH，如果与服务端发来的HASH一致，此时握手过程结束，之后所有的通信数据将由之前浏览器生成的随机密码并利用对称加密算法进行加密。

# http头部信息

![这里写图片描述](http://img.blog.csdn.net/20160717175604301)

如上图所示http报文头部包括三部分

1. 通用头部

   通用头域包含请求和响应消息都支持的头域。

   ```http
   Request URL:请求的URL地址
   Request Method: 请求方法，get/post/put/……
   Status Code：状态码，200 为请求成功
   Remote Address：路由地址
   ```

   

2. 请求头部

   ```http
     	 1） Accept：告诉WEB服务器自己接受什么介质类型，*/* 表示任何类型，type/* 表示该类型下的所有子类型；
        2）Accept-Charset：浏览器申明自己接收的字符集
        Accept-Encoding：浏览器申明自己接收的编码方法，通常指定压缩方法，是否支持压缩，支持什么压缩方法  （gzip，deflate）
        3）Accept-Language：浏览器申明自己接收的语言。语言跟字符集的区别：中文是语言，中文有多种字符集，比如big5，gb2312，gbk等等。
        4）Authorization：  当客户端接收到来自WEB服务器的 WWW-Authenticate 响应时，该头部来回应自己的身份验证信息给WEB服务器。
        5）Connection：表示是否需要持久连接。close（告诉WEB服务器或者代理服务器，在完成本次请求的响应后，断开连接，
        不要等待本次连接的后续请求了）。keep-alive（告诉WEB服务器或者代理服务器，在完成本次请求的响应后，保持连接，等待本次连接的后续请求）。
        6）Referer：发送请求页面URL。浏览器向 WEB 服务器表明自己是从哪个 网页/URL 获得/点击 当前请求中的网址/URL。
        7）User-Agent: 浏览器表明自己的身份（是哪种浏览器）。
        8）Host： 发送请求页面所在域。
        9）Cache-Control：浏览器应遵循的缓存机制。
               no-cache（不要缓存的实体，要求现在从WEB服务器去取）
               max-age：（只接受 Age 值小于 max-age 值，并且没有过期的对象） 
               max-stale：（可以接受过去的对象，但是过期时间必须小于 max-stale 值）  
               min-fresh：（接受其新鲜生命期大于其当前 Age 跟 min-fresh 值之和的缓存对象）
        10）Pramga：主要使用 Pramga: no-cache，相当于 Cache-Control： no-cache。
        11）Range：浏览器（比如 Flashget 多线程下载时）告诉 WEB 服务器自己想取对象的哪部分。
        12）Form：一种请求头标，给定控制用户代理的人工用户的电子邮件地址。
        13）Cookie：这是最重要的请求头信息之一
   ```

3. 响应头部

   ```http
   	  1）Age：当代理服务器用自己缓存的实体去响应请求时，用该头部表明该实体从产生到现在经过多长时间了。
         2）Accept-Ranges：WEB服务器表明自己是否接受获取其某个实体的一部分（比如文件的一部分）的请求。bytes：表示接受，none：表示不接受。
         3） Cache-Control：服务器应遵循的缓存机制。
                 public(可以用 Cached 内容回应任何用户)
                 private（只能用缓存内容回应先前请求该内容的那个用户）
                 no-cache（可以缓存，但是只有在跟WEB服务器验证了其有效后，才能返回给客户端） 
                 max-age：（本响应包含的对象的过期时间）  
                 ALL:  no-store（不允许缓存）  
         4） Connection： 是否需要持久连接
                 close（连接已经关闭）。
                 keepalive（连接保持着，在等待本次连接的后续请求）。
                 Keep-Alive：如果浏览器请求保持连接，则该头部表明希望 WEB 服务器保持连接多长时间（秒）。例如：Keep-Alive：300
         5）Content-Encoding：WEB服务器表明自己使用了什么压缩方法（gzip，deflate）压缩响应中的对象。 例如：Content-Encoding：gzip 
         6）Content-Language：WEB 服务器告诉浏览器自己响应的对象的语言。
         7）Content-Length：WEB 服务器告诉浏览器自己响应的对象的长度。例如：Content-Length: 26012
         8）Content-Range：WEB 服务器表明该响应包含的部分对象为整个对象的哪个部分。例如：Content-Range: bytes 21010-47021/47022
         9）Content-Type：WEB 服务器告诉浏览器自己响应的对象的类型。例如：Content-Type：application/xml
        10）Expired：WEB服务器表明该实体将在什么时候过期，对于过期了的对象，只有在跟WEB服务器验证了其有效性后，才能用来响应客户请求。
        11） Last-Modified：WEB 服务器认为对象的最后修改时间，比如文件的最后修改时间，动态页面的最后产生时间等等。
        12） Location：WEB 服务器告诉浏览器，试图访问的对象已经被移到别的位置了，到该头部指定的位置去取。
        13）Proxy-Authenticate： 代理服务器响应浏览器，要求其提供代理身份验证信息。
        14）Server: WEB 服务器表明自己是什么软件及版本等信息。
        15）Refresh：表示浏览器应该在多少时间之后刷新文档，以秒计。
   ```

   