## 什么是开窗函数/分析函数？

开窗函数是Mysql 8.0版本之后增加的新功能，类似于group by的功能，常与聚合函数搭配，区别在于开窗函数有专用的开窗函数，可以进行排序,其语法结构：

```mysql
<开窗函数> over ([PARTITION by <列清单>]
                     Order by <排序用列清单>）
```

1. 能够作为开窗函数的聚合函数：（sum,avg,count,max,min）

   ```mysql
   #sum 聚合函数的使用
   select product_id,product_name,product_type,sale_price,
   sum(sale_price) over  (order by product_id)  as '排序1'
   from product
   ```

   ![img](https://pic1.zhimg.com/80/v2-a154b4ea7a0af1420d0db8f8e4b5a1bd_1440w.jpg)

2. 排序开窗函数：（Rank,Dense_Rank,Row_Number）

   ```mysql
   #下面将3种函数排序结果分被定义为 排序1，排序2，排序3，进行结果输出：
   select product_id,product_name,product_type,sale_price,
   rank() over  (order by sale_price asc)  as '排序1',
   dense_rank() over  (order by sale_price asc)  as '排序2',
   row_number() over  (order by sale_price asc)  as '排序3'
   from product
   ```

   ![img](https://picb.zhimg.com/80/v2-2d99bd684f5dce0ddebcf30544371e89_1440w.jpg)

   Rank函数是记录排序顺序的函数，不同于Group by 函数，开窗函数的使用不会减少数据表的函数，类别也不会只有一种。

   dense_rank 函数在计算并列结果时，并列值不占位，出现连续两个3号位时，后面计数结果仍为4；

   row-number 无论sale_price 值是否一致，都会计算一个唯一值，并不会计算连续值。

